tibble(main=immgen$label.main,fine=immgen$label.fine)
tibble(main=immgen$label.main,fine=immgen$label.fine) %>% unique()
mainFine <- tibble(main=immgen$label.main,fine=immgen$label.fine) %>% unique()
count
dat
immgen$label.main
immgen$label.fine
dat$labels
dat %>% separate(labels,c(main,fine),sep='(')
dat %>% as.tibble() %>% separate(labels,c(main,fine),sep='(')
dat %>% as.tibble() %>% separate(labels,c('main','fine'),sep='(')
dat %>% as.tibble() %>% separate(labels,c('main','fine'),sep='\\(')
dat
dat %>% mutate(hello=2)
dat$labels %>% str_extract('\\(.*\\)')
dat$labels %>% str_extract('?<=\\(.*\\)')
dat$labels %>% str_extract('?=\\(.*\\)')
dat$labels %>% str_extract('?\\(.*\\)')
dat$labels %>% str_extract('?<=(\\().*\\)')
dat$labels %>% str_extract('?<=(\\().*')
dat$labels %>% str_extract('?<=(\\().')
dat$labels %>% str_extract('(?<=\\().')
dat$labels %>% str_extract('(?<=\\()\\w+')
dat$labels %>% str_extract('(?<=\\()[AZaz ]')
dat$labels %>% str_extract('(?<=\\()[AZaz ]+')
dat$labels %>% str_extract('(?<=\\()[A-Za-z ]+')
dat$labels %>% str_extract('(?<=\\().*')
dat$labels %>% str_extract('(?<=\\().(?=\\)*')
dat$labels %>% str_extract('(?<=\\().(?=\\))*')
dat$labels %>% str_extract('(?<=\\().(?>=\\))*')
dat$labels %>% str_extract('(?<=\\().(?:=\\))*')
dat$labels %>% str_extract('(?<=\\().(?=\\))*')
dat$labels %>% str_extract('(?<=\\().*(?=\\))')
dat$labels %>% str_extract('.*(?= \\())')
dat$labels %>% str_extract('.*(?= \\()')
dat <- readRDS('singler_raw.rds')
dat$main <- dat$labels %>% str_extract('.*(?= \\()')
dat$fine <- dat$labels %>% str_extract('(?<=\\().*(?=\\))')
dat$labels <- NA
dat$labels
dat$labels <- c()
dat$main
dat$fine
count <- dat$main %>% table() %>% sort(decreasing=T)
count %>% view()
library(SingleR)
library(tidyverse)
# stuff -------------------------------------------------------------------
coarse <- readRDS('sc_data/singler_coarse.rds')
fine <- readRDS('sc_data/singler_fine.rds')
fine
fine %>% head()
fine$tuning.scores
fine$labels
fine$first.labels
fine$labels
fine$labels[1]
fine$labels %>% table() %>% sort(decreasing=T)
fine$labels %>% table() %>% sort(decreasing=T) %>% view()
fine$first.labels %>% table() %>% sort(decreasing=T) %>% view()
library(Seurat)
library(tidyverse)
# libraries ---------------------------------------------------------------
library(Seurat)
library(tidyverse)
# stuff -------------------------------------------------------------------
meta <- readRDS('sc_data/metadata.rds')
mark <- readRDS('sc_data/all_markers.rds')
meta
meta %>% class()
meta %>% head()
mark
mark %>% class()
mark %>% head()
dim(mark)
mark$cluster %>% table()
mark[mark$cluster==13,]
unique(mark$cluster)
levels(mark$cluster)
mark[mark$cluster=='13',]
map(levels(mark$cluster),function(l){
mark[mark$cluster==l,][2,]
})
mark[mark$cluster==l,][1:2,]
map(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:2,]
})
map(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:2,]
}) %>% unlist()
map(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:2,]
}) %>% flatten()
map_dfr(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:2,]
}) %>%
for(l in levels(mark$cluster)){
}
map_dfr(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:2,]
})
topMarkers <- map_dfr(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:10,]
})
topMarkers %>% view()
data.table::fread('CellMarker.csv')
data.table::fread('CellMarker.csv') %>% view()
mark %>% view()
mark$cluster %>% table() %>% view()
mark$avg_logFC
mark$positivity <- ifelse(mark$avg_logFC>0,T,F)
mark$positivity
library(Seurat)
library(tidyverse)
# stuff -------------------------------------------------------------------
meta <- readRDS('sc_data/metadata.rds')
mark <- readRDS('sc_data/all_markers.rds')
mark$positivity <- ifelse(mark$avg_logFC>0,T,F)
topMarkers <- map_dfr(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:10,]
})
mark
mark %>% head()
mark[c('CD235A'),]
mark[c('CD235'),]
mark[c('ter119'),]
mark[c('TER119'),]
mark[c('CD8'),]
mark[c('CD8A'),]
feats <- rownames(mark)
feats %>% head()
feats %>% str_extract('CD235')
feats[str_detect('CD235')]
feats[str_detect(feats,'CD235')]
feats[str_detect(feats,'CD9')]
feats[str_detect(feats,'CD23')]
feats[str_detect(feats,'CD2')]
feats[str_detect(feats,'CD14')]
mark[str_detect(feats,'CD14')]
mark[str_detect(feats,'CD14'),]
sf <- function(genes){
feats[str_detect(feats,genes)]
}
ff <- function(genes){
mark[str_detect(feats,genes),]
}
sf('CD11b')
sf('CD11B')
toupper(c('a','b'))
sf <- function(genes){
feats[str_detect(feats,toupper(genes))]
}
ff <- function(genes){
mark[str_detect(feats,toupper(genes)),]
}
sf('cd11')
sf('cd1')
sf('cd68')
ff('cd68')
sf('cd16')
sf('cd11')
sf('HLA')
sf('HLA-dr')
obj <- 'CD7-,CD10-,CD45RA-,CD135-,IL3RA-,CD235A,CD41B,CD42A,CD42B,CD61,CD41,CD42A,CD42B,CD61,CD10-,CD45RA,CD123,CD135,CD10,CD45RA,CD14,CD11B,CD68,CD163,CD11C,HLA-DR,CD11B,CD16,CD18,CD32,CD44,CD55,CD45,CD125,CD193,F4/80,SIGLEC-8,CD19-,CD22,CD45lo,CD123,CD32,CD33,CD117,CD203C,FCERI,CD3-,CD56,CD94,NKP46,CD3,CD19,BLNK, CD19, CD79A, CD79B, MS4A1,CD37, CD79ACD14, CD16, CD68, S100A12,CCR7, CD27, IL7R,D4, CTLA4, FOXP3, IL2RA,CD4, CD8A, CD8B,CD8A, CD8B, GZMK,CLEC4C, IL3RA, NRP1,ADAM8, ADGRG1, ADRB2, AGTPBP1, AHNAK, ARHGAP25, ARL4C, BIN2, C12orf75, C1orf21, CAPN2, CASP8, CD300A, CEP78, CX3CR1, DSTN, EFHD2, EMP3, FCGR3A, FCGR3B, FCRL6, FGFBP2, FGR, FLNA, FUT11, GAB3, GK5, GLUL, GNLY, GZMB, GZMH, ITGAM, KCNAB2, KLRD1, KLRF1, LGALS1, LILRB1, LITAF, LLGL2, LPCAT1, LUZP6, MBP, MTSS1, MYO1F, MYO1G, OSBPL5, PATL2, PIK3R5, PLEK, PLEKHG3, PRKCB, PRSS23, PXN, RAP1B, RAP1GAP2, RAP2B, RASSF1, RGS19, RNF166, S1PR5, SAMD3, SH3BP5, SH3BP5-AS1, SLC2A1, SLC9A3R1, SLCO4C1, SPON2, SRPK2, STK10, SYNE1, TAGLN2, TBX21, TGFBR3, TM4SF19, TM4SF19-TCTEX1D2, TPST2, TTC16, TTC38, USP28, VCL, VEZF1, WDR37, ZEB2, ZEB2-AS1, ZNF600,CDH5, SELE, VWF,COL1A1, COL3A1, FAP, THY1,CD14, CD163, CD68, CSF1R, FCGR3A,PF4, PLA2G12A, PPBP,CD1C, CST3, FCER1A,ABLIM1, ACTN1, C1orf162, C6orf48, CCR7, CD55, EEF1B2, EIF3L, FAM117B, FHIT, GIMAP5, GIMAP8, GPR183, IL7R, LDLRAP1, LRRC75A-AS1, LRRN3, MAL, MYC, NELL2, NOSIP, PRKCA, RPS5, RSL1D1, SATB1, SERINC5, SLC40A1, SVIL, TCF7, TESPA1, TMEM204, TRABD2A, TSHZ2, TXK,ABLIM1, ACTN1, AIF1, APBA2, APEX1, ARHGAP45, ARHGEF18, ATM, BACH2, BEX4, C1orf162, C1orf228, C6orf48, CA6, CAMK4, CCR7, CD248, CD55, CEP68, COQ8A, DGKA, EEF2, EIF3E, EIF3L, EPHX2, EXOSC8, FAM102A, FAM117B, FAM60A, FKBP5, FOXP1, GAS5, GCSAM, GIMAP2, GLTSCR2, GPR155, GPR183, IGF1R, ITFG2, LDHB, LDLRAP1, LEF1, LEF1-AS1, LINC01550, LMO7, LRRC75A, LRRC75A-AS1, LRRN3, MAL, MAML2, MLXIP, MYC, NDFIP1, NELL2, NOG, NOSIP, NPAT, NPM1, NT5E, OXNAD1, PASK, PDE3B, PDK1, PIK3IP1, PLEKHB1, PRKCQ-AS1, PSIP1, R3HDM4, RACK1, RASGRP2, RCAN3, RIC3, RPS8, SCML4, SELL, SERINC5, SGSM3, SH3YL1, SMAP2, SNED1, SNURF, SPINT2, SPTBN1, STMN3, TCF7, THAP7, THEM4, TMEM123, TMEM204, TMEM63A, TNFSF8, TOMM7, TPCN1, TRABD2A, TRAP1, TRMT1, TXK, UBQLN2, VIPR1, WDR43, ZNF101,CCR7, CD27, CD8A, CD8B,CCL3, CD160, CD247, GNLY, GZMB, NKG7,FCGR3A, FCGR3B, KLRB1, KLRB1, KLRC1, KLRD1, KLRF1, KLRK1, NCAM1,CD8A, CD8B, ZNF683,CD123, GZMB,ID2,ANXA2P2, ATP2B1, B3GNT2, BIRC3, CASP2, CCDC141, CCM2, CCR10, CCR4, CCR8, CLDND1, CORO7, CORO7-PAM16, CPNE2, ELK3, F5, FAM110A, FANK1, FCMR, FCRL3, FOXP3, GLRX, HAPLN3, HPGD, IKZF2, IL10RA, IL2RA, ISG20, LMNA, METTL7A, PDP1, PI16, REREP3, RNF214, RTKN2, SAMHD1, SELPLG, SNX20, STAM, TBC1D4, TLDC2, TRIM16, TTC39C, TTN, USP15,CCR10, CD25, CD52, CMTM7, FOXP3,CD4, CTLA4, FOXP3, IL2RA,CD27, CD28, CD3D, CD3E, CD3G'
library(Seurat)
library(tidyverse)
meta <- readRDS('sc_data/metadata.rds')
mark <- readRDS('sc_data/all_markers.rds')
mark$positivity <- ifelse(mark$avg_logFC>0,T,F)
mark$cluster %>% table() %>% view()
topMarkers <- map_dfr(levels(mark$cluster),function(l){
mark[mark$cluster==l,][1:10,]
})
feats <- rownames(mark)
sf <- function(genes){
feats[str_detect(feats,toupper(genes))]
}
ff <- function(genes){
mark[str_detect(feats,toupper(genes)),]
}
str_split('skdlf,lskdf,ek ,slk , sdj')
str_split('skdlf,lskdf,ek ,slk , sdj',',')
obj
str_split(obj,',')
str_split(obj,',') %>% str_trim('both')
str_split(obj,',') %>% str_trim(side='both')
str_split(obj,',')
str_split(obj,',') %>% unlist()
str_split(obj,',') %>% unlist() %>% str_trim('both')
str_split(obj,',') %>% unlist() %>% str_trim('both') %>%
data.frame('h'=.)
data.frame('feat'=str_split(obj,',') %>% unlist() %>% str_trim('both'))
searchFeats <- data.frame('feat'=str_split(obj,',') %>% unlist() %>% str_trim('both'))
searchFeats <- data.frame('feat'=str_split(obj,',') %>% unlist() %>% str_trim('both'), 'positive'=NA)
searchFeats
?rowwise
rowwise(searchFeats)
if(rowwise(searchFeats)$feat=='CD10'){print(1)}
if(rowwise(searchFeats)=='CD10'){print(1)}
for(i in rowwise(searchFeats)){print(1)}
pmap_dfr(searchFeats,function(...){
curr <- data.frame(...)
print(curr$feat)
})
str_detect(searchFeats$feat,'-$')
searchFeats$positive <- str_detect(searchFeats$feat,'-$')
searchFeats
saveRDS(searchFeats,'searchFeats.rds')
c(c(3,4),5)
list('h'=5,'y'=c94,5)
list('h'=5,'y'=c(94,5))
h1 <- list(TCELL = 'CD3',
#HELPER T CELLS
TH = 'CD4',
TH1 = 'TNF,IL2,IFNG,CXCR3',
TH2 = 'IL4,IL5,IL9,IL10,CCR4',
TH17 = 'IL21,IL22,IL25,IL17,CCR6',
TH22 = 'IL22,CCR10',
TH9 = 'IL9',
TFH = 'IL21',
#CYTOTOXIC T CELLS
TC = 'TRA,TRB,CD8,CD28',
TC1 = 'TNF,IFNG,IL2,CXCR3,TBX21',
TC2 = 'IL4,IL5,CCR4,GATA3',
TC9 = 'IL9,IL10,IRF4',
TC17 = 'CCR6,KLRB1,IL17,IRF4,RORC',
#REGULATOR T CELLS (cd8 or cd4)
TREG = 'FOXP3,IL2RA,STAT5A,CTLA4,IL10,TGFB1',
TNAIVE = 'CD45RA,CD103',
TEM = 'GZMA',
TRM = 'CD69,ITGAE,CTLA4',
TSCM = 'CD62L',
TEFF = 'GZMA',
TNKT = 'NCAM1,CD16',
TGD = 'TRG,TRD',
#MACRO
MACROPHAGE = 'CD14,CD16,CD64,CD68,CD71,CCR5',
# MORE AT "https://www.bio-rad-antibodies.com/macrophage-m1-m2-tam-tcr-cd169-cd-markers-antibodies.html"
NEUTROPHIL = 'CD15,CD16,FCGR3A,CD66B,CEACAM8,ITGAM,CD33,MPO',
BASOPHIL = 'CCR3,CD11C,SIGLEC-2,CD22,CD69,PTGDR2,ENPP3,FCER1A,IL3RA,ITGA2',
EOSINOPHIL = 'CCR3,ITGAM,CD15,CD45,CEACAM8,EMR1,IL5RA,CD125,ITGA4,CD49D,SIGLEC8',
# MONO
MONOCLASS = 'CD14,CCR2,CCR5,CD62L',
MONONCLASS = 'CD14,CD16,CX3CR1,HLA-DR',
MONOINT = 'CD14,CD16,HLA-DR,CD68,ITGAX',
NK = 'CD56',
GRANULOCYTE = 'CD66B',
MAST = 'SIGLEC3,PTPRC,KIT,ENPP3,FCGR2,FCER1A,MITF',
#DC
DCC = 'BDCA1,CD8,CD8A,ITGAM,ITGAX,ITGAE,LY75,HLA-DRA,HLA-DRB',
DCP ='BDCA2,BDCA4,CD45RA,IL3RA,ILT7,TLR7,TLR9',
#B CELL
B = 'CD19,CD24,CD40,CD72',
B1 = 'CD20,CD27,CD43,SPN',
BNAIVE = 'IGD,CD22',
BPLASMA = 'CD27,CD38,BLIMP1,XBP1,IRF4,CD138,BCL2,BCL6,SDC1',
BMEM = 'CD27,BCL2,NT5E',
BREG = 'IL10,IL35,CD1D,CD24,CD5,CD44,CD38,TFRC,HAVCR1')
for(i in h1){
stringr::str_split(i,',')
}
h2 <- purrr::map(h1,function(i){
strsplit(i,',')
})
names(h2)
print('hello',c(4,5))
print(paste('hello',c(4,5)))
print(paste('hello',c(4,5),recycle0=F))
print(paste('hello',c(4,5),recycle0=T))
print(paste('hello',c(4,5),collapse=''))
for(i in h2) print(i)
h2
for(i in h2) print(i)
for(i in h2) print(names(i))
h2$BREG[[1]]
h3 <- 'BREG'
h2$h3
for(i in names(h2)) print(names(i))
for(i in names(h2)) print(i)
for(i in names(h2)) print(h2[[i]])
for(i in names(h2)) print(h2[[i]][[1]])
h2[['j']]
h1 <- list(TCELL = 'CD3D',
#HELPER T CELLS
TH = 'CD4',
TH1 = 'TNF,IL2,IFNG,CXCR3',
TH2 = 'IL4,IL5,IL9,IL10,CCR4',
TH17 = 'IL21,IL22,IL25,IL17A,CCR6',
TH22 = 'IL22,CCR10',
TH9 = 'IL9',
TFH = 'IL21',
#CYTOTOXIC T CELLS
TC = 'TRAC,TRBV1,TRBV2,TRBC2,CD8A,CD8B,CD28',
TC1 = 'TNF,IFNG,IL2,CXCR3,TBX21',
TC2 = 'IL4,IL5,CCR4,GATA3',
TC9 = 'IL9,IL10,IRF4',
TC17 = 'CCR6,KLRB1,IL17A,IRF4,RORC',
#REGULATOR T CELLS (cd8 or cd4)
TREG = 'FOXP3,IL2RA,STAT5A,CTLA4,IL10,TGFB1',
TNAIVE = 'ITGAE',
TEM = 'GZMA',
TRM = 'CD69,ITGAE,CTLA4',
TSCM = 'SELL',
TEFF = 'GZMA',
TNKT = 'NCAM1,FCGR3A',
TGD = 'TRGC1,TRGC2,TRDC',
#MACRO
MACROPHAGE = 'CD14,FCGR3A,FCGR1A,CD68,TFRC,CCR5',
# MORE AT "https://www.bio-rad-antibodies.com/macrophage-m1-m2-tam-tcr-FCGR3A9-cd-markers-antibodies.html"
NEUTROPHIL = 'FUT4,FCGR3A,FCGR3A,CEACAM8,CEACAM8,ITGAM,CD33,MPO',
BASOPHIL = 'CCR3,ITGAX,CD22,CD22,CD69,PTGDR2,ENPP3,FCER1A,IL3RA,ITGA2',
EOSINOPHIL = 'CCR3,ITGAM,FUT4,PTPRCCEACAM8,ADGRE1,IL5RA,IL5RA,ITGA4,ITGA4,SIGLEC8',
# MONO
MONOCLASS = 'CD14,CCR2,CCR5,SELL',
MONONCLASS = 'CD14,FCGR3A,CX3CR1',
MONOINT = 'CD14,FCGR3A,CD68,ITGAX',
NK = 'NCAM1',
GRANULOCYTE = 'CEACAM8',
MAST = 'PTPRC,KIT,ENPP3,FCGR2A,FCGR2B,FCER1A,MITF',
#DC
DCC = 'CD1C,CD8,CD8A,ITGAM,ITGAX,ITGAE,LY75',
DCP ='CLEC4C,NRP1,IL3RA,LILRA4,TLR7,TLR9',
#B CELL
B = 'CD19,CD24,CD40,CD72',
B1 = 'MS4A1,CD27,SPN',
BNAIVE = 'CD22',
BPLASMA = 'CD27,CD38,PRDM1,XBP1,IRF4,SDC1,BCL2,BCL6,SDC1',
BMEM = 'CD27,BCL2,NT5E',
BREG = 'IL10,CD1D,CD24,CD5,CD44,CD38,TFRC,HAVCR1')
for(i in h1){
stringr::str_split(i,',')
}
h2 <- purrr::map(h1,function(i){
strsplit(i,',')
})
saveRDS(h2,'data/searchF2.rds')
saveRDS(h2,'searchF2.rds')
h1 <- list(TCELL = 'CD3D',
#HELPER T CELLS
TH = 'CD4',
TH1 = 'TNF,IL2,IFNG,CXCR3',
TH2 = 'IL4,IL5,IL9,IL10,CCR4',
TH17 = 'IL21,IL22,IL25,IL17A,CCR6',
TH22 = 'IL22,CCR10',
TH9 = 'IL9',
TFH = 'IL21',
#CYTOTOXIC T CELLS
TC = 'TRAC,TRBV1,TRBV2,TRBC2,CD8A,CD8B,CD28',
TC1 = 'TNF,IFNG,IL2,CXCR3,TBX21',
TC2 = 'IL4,IL5,CCR4,GATA3',
TC9 = 'IL9,IL10,IRF4',
TC17 = 'CCR6,KLRB1,IL17A,IRF4,RORC',
#REGULATOR T CELLS (cd8 or cd4)
TREG = 'FOXP3,IL2RA,STAT5A,CTLA4,IL10,TGFB1',
TNAIVE = 'ITGAE',
TEM = 'GZMA',
TRM = 'CD69,ITGAE,CTLA4',
TSCM = 'SELL',
TEFF = 'GZMA',
TNKT = 'NCAM1,FCGR3A',
TGD = 'TRGC1,TRGC2,TRDC',
#MACRO
MACROPHAGE = 'CD14,FCGR3A,FCGR1A,CD68,TFRC,CCR5',
# MORE AT "https://www.bio-rad-antibodies.com/macrophage-m1-m2-tam-tcr-FCGR3A9-cd-markers-antibodies.html"
NEUTROPHIL = 'FUT4,FCGR3A,FCGR3A,CEACAM8,CEACAM8,ITGAM,CD33,MPO',
BASOPHIL = 'CCR3,ITGAX,CD22,CD22,CD69,PTGDR2,ENPP3,FCER1A,IL3RA,ITGA2',
EOSINOPHIL = 'CCR3,ITGAM,FUT4,PTPRC,CEACAM8,ADGRE1,IL5RA,IL5RA,ITGA4,ITGA4,SIGLEC8',
# MONO
MONOCLASS = 'CD14,CCR2,CCR5,SELL',
MONONCLASS = 'CD14,FCGR3A,CX3CR1',
MONOINT = 'CD14,FCGR3A,CD68,ITGAX',
NK = 'NCAM1',
GRANULOCYTE = 'CEACAM8',
MAST = 'PTPRC,KIT,ENPP3,FCGR2A,FCGR2B,FCER1A,MITF',
#DC
DCC = 'CD1C,CD8B,CD8A,ITGAM,ITGAX,ITGAE,LY75',
DCP ='CLEC4C,NRP1,IL3RA,LILRA4,TLR7,TLR9',
#B CELL
B = 'CD19,CD24,CD40,CD72',
B1 = 'MS4A1,CD27,SPN',
BNAIVE = 'CD22',
BPLASMA = 'CD27,CD38,PRDM1,XBP1,IRF4,SDC1,BCL2,BCL6,SDC1',
BMEM = 'CD27,BCL2,NT5E',
BREG = 'IL10,CD1D,CD24,CD5,CD44,CD38,TFRC,HAVCR1')
for(i in h1){
stringr::str_split(i,',')
}
h2 <- purrr::map(h1,function(i){
strsplit(i,',')
})
saveRDS(h2,'searchF2.rds')
library(tidyverse)
# object2 -----------------------------------------------------------------
# higher specificity
h2 <- list(TCELL = 'CD3D,CD3G,CD3E',
#HELPER T CELLS
TH = 'CD4',
# TH1 = 'TNF,IL2,IFNG,CXCR3',
# TH2 = 'IL4,IL5,IL9,IL10,CCR4',
# TH17 = 'IL21,IL22,IL25,IL17A,CCR6',
# TH22 = 'IL22,CCR10',
# TH9 = 'IL9',
# TFH = 'IL21',
#
# #CYTOTOXIC T CELLS
TC = 'TRAC,TRBV1,TRBV2,TRBC2,CD8A,CD8B,CD28',
# TC1 = 'TNF,IFNG,IL2,CXCR3,TBX21',
# TC2 = 'IL4,IL5,CCR4,GATA3',
# TC9 = 'IL9,IL10,IRF4',
# TC17 = 'CCR6,KLRB1,IL17A,IRF4,RORC',
#
# #REGULATOR T CELLS (cd8 or cd4)
# TREG = 'FOXP3,IL2RA,STAT5A,CTLA4,IL10,TGFB1',
#
# TNAIVE = 'ITGAE',
# TEM = 'GZMA',
# TRM = 'CD69,ITGAE,CTLA4',
# TSCM = 'SELL',
# TEFF = 'GZMA',
#
# TNKT = 'NCAM1,FCGR3A',
# TGD = 'TRGC1,TRGC2,TRDC',
#
# #MACRO
MACRO = 'CD163,CD68,ITGAM',
# # MORE AT "https://www.bio-rad-antibodies.com/macrophage-m1-m2-tam-tcr-FCGR3A9-cd-markers-antibodies.html"
# # MONO
MONO = 'CD14,FCGR1A,FCGR3A',
# NK = 'NCAM1',
GRANULOCYTE = 'CEACAM8',
#
# #DC
DCC = 'CD1C,CD83,CD209,THBD',
DCP ='CLEC4C,NRP1,IL3RA',
#
# #B CELL
B = 'CD19',
# B1 = 'MS4A1,CD27,SPN',
# BNAIVE = 'CD22',
# BMZ = '',
BMATURE = 'IGHM',
BPLASMA = 'IGHG1,IGHG2,IGHG3,SDC1',
# BMEM = 'CD27,BCL2,NT5E',
BREG = 'IL10')
for(i in h1){
stringr::str_split(i,',')
}
h2 <- purrr::map(h1,function(i){
strsplit(i,',')
})
saveRDS(h2,'searchF2.rds')
# object2 -----------------------------------------------------------------
# higher specificity
h2 <- list(TCELL = 'CD3D,CD3G,CD3E',
#HELPER T CELLS
TH = 'CD4',
# TH1 = 'TNF,IL2,IFNG,CXCR3',
# TH2 = 'IL4,IL5,IL9,IL10,CCR4',
# TH17 = 'IL21,IL22,IL25,IL17A,CCR6',
# TH22 = 'IL22,CCR10',
# TH9 = 'IL9',
# TFH = 'IL21',
#
# #CYTOTOXIC T CELLS
TC = 'TRAC,TRBV1,TRBV2,TRBC2,CD8A,CD8B,CD28',
# TC1 = 'TNF,IFNG,IL2,CXCR3,TBX21',
# TC2 = 'IL4,IL5,CCR4,GATA3',
# TC9 = 'IL9,IL10,IRF4',
# TC17 = 'CCR6,KLRB1,IL17A,IRF4,RORC',
#
# #REGULATOR T CELLS (cd8 or cd4)
# TREG = 'FOXP3,IL2RA,STAT5A,CTLA4,IL10,TGFB1',
#
# TNAIVE = 'ITGAE',
# TEM = 'GZMA',
# TRM = 'CD69,ITGAE,CTLA4',
# TSCM = 'SELL',
# TEFF = 'GZMA',
#
# TNKT = 'NCAM1,FCGR3A',
# TGD = 'TRGC1,TRGC2,TRDC',
#
# #MACRO
MACRO = 'CD163,CD68,ITGAM',
# # MORE AT "https://www.bio-rad-antibodies.com/macrophage-m1-m2-tam-tcr-FCGR3A9-cd-markers-antibodies.html"
# # MONO
MONO = 'CD14,FCGR1A,FCGR3A',
# NK = 'NCAM1',
GRANULOCYTE = 'CEACAM8',
#
# #DC
DCC = 'CD1C,CD83,CD209,THBD',
DCP ='CLEC4C,NRP1,IL3RA',
#
# #B CELL
B = 'CD19',
# B1 = 'MS4A1,CD27,SPN',
# BNAIVE = 'CD22',
# BMZ = '',
BMATURE = 'IGHM',
BPLASMA = 'IGHG1,IGHG2,IGHG3,SDC1',
# BMEM = 'CD27,BCL2,NT5E',
BREG = 'IL10')
for(i in h2){
stringr::str_split(i,',')
}
h2 <- purrr::map(h2,function(i){
strsplit(i,',')
})
saveRDS(h2,'searchF3.rds')
library(Seurat)
?FindMarkers
