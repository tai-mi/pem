dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract('\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value))
}
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract('\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))
}
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract('\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster)) %>% print()
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(as.factor(cluster),value,fill=cluster))
}
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(as.factor(cluster),value,fill=cluster))
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x) %>%
y <- as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(as.factor(cluster),value,fill=cluster))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
y <- as_tibble(x,rownames='cluster') %>%
mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(as.factor(cluster),value,fill=cluster))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
y <- as_tibble(x,rownames='cluster') %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(as.factor(cluster),value,fill=cluster))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
y <- as_tibble(x,rownames='cluster') %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(as.factor(cluster),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
y <- as_tibble(x,rownames='cluster') %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
y <- as_tibble(x,rownames='cluster') %>%
arrange(str_extract(x,'\\d+') %>% as.numeric())
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
y <- as_tibble(x,rownames='cluster') %>%
arrange(str_extract(x,'\\d+') %>% as.numeric()) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
y
x
x <- ifelse(is.na(x),0,x)
x
y <- as_tibble(x,rownames='cluster') %>%
arrange(str_extract(x,'\\d+') %>% as.numeric())
y
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
y <- as_tibble(x,rownames='cluster') %>%
arrange(str_extract(value,'\\d+') %>% as.numeric()) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
x
as_tibble(x,rownames='cluster') %>% arrange(str_extract(value,'\\d+') %>% as.numeric())
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
x %<>% arrange(str_extract(x$value,'\\d+') %>% as.numeric()) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
x
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
x %<>% arrange(str_extract(x$value,'\\d+') %>% as.numeric()) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
x
}
dev('ccnd3')
x
x <- as_tibble(x,rownames='cluster')
x
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(value,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
x
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(value,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
?reorder
x
y <- mutate(x,c2=str_extract(value,'\\d+') %>% as.numeric()) %>%
arrange(c2)
y
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(rcluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(cluster,value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2)
y
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric())
y
reorder(y$cluster,y$c2)
str(y)
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))+ylim(c(1,-1))
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))+ylim(c(1,-1))+
geom_hline(yintercept=0)
y
}
dev('ccnd3')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90))+ylim(c(-1,1))+
geom_hline(yintercept=0)
y
}
dev('ccnd3')
?theme
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90,),legend.position='none')+
ylim(c(-1,1))+geom_hline(yintercept=0)
y
}
dev('ccnd3')
dev('cd8a')
gene <- 'cd8a'
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90,),legend.position='none')+
ylim(c(-1,1))+geom_hline(yintercept=0)
x <- as_tibble(x,rownames='cluster')
x
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
arrange(c2) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90,),legend.position='none')+
ylim(c(-1,1))+geom_hline(yintercept=0)
y
view(x)
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric())
y
y %>% view()
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90,),legend.position='none')+
ylim(c(-1,1))+geom_hline(yintercept=0)
y
}
dev('cd8b')
y %>% view()
y %>% view()
dev('cd8a')
dev <- function(gene){
gene %<>% toupper()
x <- map(mark,~.x[gene,'avg_log2FC']) %>%
unlist()
x <- ifelse(is.na(x),0,x)
x <- as_tibble(x,rownames='cluster')
y <- mutate(x,c2=str_extract(cluster,'\\d+') %>% as.numeric()) %>%
# mutate(cluster=str_extract(value,'\\d+') %>% as.numeric) %>%
ggplot()+geom_col(aes(reorder(cluster,c2),value,fill=cluster))+
theme(axis.text.x=element_text(angle=90,),legend.position='none')+
ylim(c(min(c(-0.5,x$value)),max(c(0.5,x$value))))+
geom_hline(yintercept=0)
y
}
dev('cd8a')
dev('cd8b')
dev('cd4')
dev('IL2')
dev('CCR3')
dev('CCR4')
dev('CCR5')
dev('CCR6')
dev('CCR10')
dev('il7r')
dev('foxp3')
dev('clec9a')
dev('TRGC')
dev('cd69')
dev('ccr7')
dev('ifng')
dev('tnfa')
dev('cxcr3')
dev('il12rb2')
dev('tbx21')
dev('CD8a')
dev('CD8b')
dev('cd4')
dev('cd3d')
dev('cd3e')
dev('cd3g')
dev('ctla4')
dev('cd38')
dev('foxo4')
dev('tgfb1')
dev('tnf')
dev('il22')
dev('il25')
dev('il26')
dev('il21')
dev('il17')
dev('il17a')
dev('il13')
dev('il10')
dev('PTGDR2')
dev('PECAM1')
dev('itgae')
dev('gzma')
dev('stat4')
dev('stat5')
dev('lef1')
dev('IL7R')
dev('SELL')
dev('PD1')
dev('PDL1')
dev('TOX')
dev('LAG3')
dev('tim3')
dev('tigit')
dev('ki67')
dev('mki67')
dev('cxcr3')
dev('il4')
dev('il5')
dev('il9')
dev('irf4')
dev('ccr4')
dev('gata3')
dev('ccr6')
dev('klrb1')
dev('il17')
dev('irf4')
dev('rorc')
dev('il17a')
dev('il17f')
dev('il17b')
dev('itga1')
dev('cxcr6')
dev('jaml')
dev('itgae')
dev('jaml')
dev('xcl1')
dev('ifng')
dev('HLA-DRA')
dev('HLA-DRB')
dev('HLA-DRB5')
dev('HLA-DRB1')
dev('TBX21')
dev('CD8A')
dev('RORYT')
dev('il23r')
dev('trav24')
dev('trbv11')
dev('fcgr3a')
dev('fcgr3b')
dev('ccr4')
dev('il12rb2')
dev('ccr3')
dev('spi1')
dev('IL17')
dev('IL17A')
dev('IL17B')
dev('IL17F')
dev('TRBV11')
dev('TRAJ18')
dev('TRVA14')
dev('TRJA18')
dev('TRAJ18')
dev('TRAV14')
dev('TRBV8')
dev('TRBV8.2')
dev('TRBV82')
dev('TRBV7')
dev('TRBV2')
dev('KLRB1')
dev('cd56')
dev('ncam1')
